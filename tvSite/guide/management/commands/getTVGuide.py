from django.core.management.base import BaseCommand, CommandErrorfrom tvSite.guide.models import Show, GuideEntryfrom datetime import datetimeimport urllib2from xml.dom.minidom import parse, parseStringdef dlGuide():    URL = "http://services.tvrage.com/feeds/fullschedule.php?country=US"    print "Downloading TV Guide... "    try:        req = urllib2.Request(URL)        handle = urllib2.urlopen(req)        thepage = handle.read()    except Exception, e:        print "failed to retrieve XML data"        return    print "Parsing XML File... "    dom = parseString(thepage)      objList = []    print "Adding entries to DB... "    for a_day in dom.getElementsByTagName("DAY"):        for a_time in a_day.getElementsByTagName("time"):            for a_show in a_time.getElementsByTagName("show"):                sid = -1                for a_node in a_show.getElementsByTagName("sid"):                    sid = int(a_node.firstChild.data)                network = 'unknown'                for a_node in a_show.getElementsByTagName("network"):                    network = a_node.firstChild.data                new_show = Show()                new_show.name = a_show.getAttribute("name")                new_show.id = sid                new_show.save()                                new_entry = GuideEntry()                date_object = datetime.strptime(a_day.getAttribute("attr") +                    " " + a_time.getAttribute("attr"),'%Y-%m-%d %I:%M %p')                new_entry.start = date_object                new_entry.network = network                new_entry.show = new_show                new_entry.save()                '''db_show = Show()                db_show.id = int(my_child.data)                db_show.name = a_show.getAttribute("name")                db_show.save()                                db_startTime = StartTime()                date_object = datetime.strptime(a_day.getAttribute("attr") +                    " " + a_time.getAttribute("attr"),'%Y-%m-%d %I:%M %p')                db_startTime.start = date_object                db_startTime.save()                                db_show.start_times.add(db_startTime)'''                #Add entry to DB                #a_time.getAttribute("attr") <- this is the time                #a_day.getAttribute("attr") <- this is the day                #a_show.getAttribute("name") <- this is the name                #my_child.data <- this is the show id (sID)class Command(BaseCommand):    args = 'None Required'    help = 'TBD'    def handle(self, *args, **options):        dlGuide()